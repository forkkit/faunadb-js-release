!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).faunadb=t()}}(function(){return function o(s,u,a){function c(e,t){if(!u[e]){if(!s[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(l)return l(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var i=u[e]={exports:{}};s[e][0].call(i.exports,function(t){return c(s[e][1][t]||t)},i,i.exports,o,s,u,a)}return u[e].exports}for(var l="function"==typeof require&&require,t=0;t<a.length;t++)c(a[t]);return c}({1:[function(t,e,n){e.exports={Client:t("./src/Client"),Expr:t("./src/Expr"),PageHelper:t("./src/PageHelper"),RequestResult:t("./src/RequestResult"),clientLogger:t("./src/clientLogger"),errors:t("./src/errors"),values:t("./src/values"),query:t("./src/query")}},{"./src/Client":19,"./src/Expr":20,"./src/PageHelper":21,"./src/RequestResult":22,"./src/clientLogger":25,"./src/errors":26,"./src/query":27,"./src/values":28}],2:[function(t,e,n){"use strict";n.byteLength=function(t){var e=h(t),n=e[0],r=e[1];return 3*(n+r)/4-r},n.toByteArray=function(t){for(var e,n=h(t),r=n[0],i=n[1],o=new p((c=r,l=i,3*(c+l)/4-l)),s=0,u=0<i?r-4:r,a=0;a<u;a+=4)e=f[t.charCodeAt(a)]<<18|f[t.charCodeAt(a+1)]<<12|f[t.charCodeAt(a+2)]<<6|f[t.charCodeAt(a+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=255&e;var c,l;2===i&&(e=f[t.charCodeAt(a)]<<2|f[t.charCodeAt(a+1)]>>4,o[s++]=255&e);1===i&&(e=f[t.charCodeAt(a)]<<10|f[t.charCodeAt(a+1)]<<4|f[t.charCodeAt(a+2)]>>2,o[s++]=e>>8&255,o[s++]=255&e);return o},n.fromByteArray=function(t){for(var e,n=t.length,r=n%3,i=[],o=0,s=n-r;o<s;o+=16383)i.push(a(t,o,s<o+16383?s:o+16383));1===r?(e=t[n-1],i.push(u[e>>2]+u[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],i.push(u[e>>10]+u[e>>4&63]+u[e<<2&63]+"="));return i.join("")};for(var u=[],f=[],p="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=r.length;i<o;++i)u[i]=r[i],f[r.charCodeAt(i)]=i;function h(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function a(t,e,n){for(var r,i,o=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(u[(i=r)>>18&63]+u[i>>12&63]+u[i>>6&63]+u[63&i]);return o.join("")}f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},{}],3:[function(t,e,n){e.exports=function(t){return btoa(t)}},{}],4:[function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}void 0!==e&&(e.exports=r),r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],5:[function(M,n,r){(function(H,z){var t,e;t=this,e=function(){"use strict";function c(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,e=void 0,i=void 0,u=function(t,e){p[r]=t,p[r+1]=e,2===(r+=2)&&(i?i(h):w())};var t="undefined"!=typeof window?window:void 0,o=t||{},s=o.MutationObserver||o.WebKitMutationObserver,a="undefined"==typeof self&&void 0!==H&&"[object process]"==={}.toString.call(H),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var t=setTimeout;return function(){return t(h,1)}}var p=new Array(1e3);function h(){for(var t=0;t<r;t+=2){(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0}r=0}var d,y,m,v,w=void 0;function b(t,e){var n=this,r=new this.constructor(x);void 0===r[_]&&L(r);var i=n._state;if(i){var o=arguments[i-1];u(function(){return N(i,r,o,n._result)})}else R(n,r,t,e);return r}function g(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(x);return C(e,t),e}w=a?function(){return H.nextTick(h)}:s?(y=0,m=new s(h),v=document.createTextNode(""),m.observe(v,{characterData:!0}),function(){v.data=y=++y%2}):l?((d=new MessageChannel).port1.onmessage=h,function(){return d.port2.postMessage(0)}):void 0===t&&"function"==typeof M?function(){try{var t=Function("return this")().require("vertx");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(h)}:f()}catch(t){return f()}}():f();var _=Math.random().toString(36).substring(2);function x(){}var T=void 0,E=1,j=2,O={error:null};function S(t){try{return t.then}catch(t){return O.error=t,O}}function A(t,e,n){var r,i,o,s;e.constructor===t.constructor&&n===b&&e.constructor.resolve===g?(o=t,(s=e)._state===E?k(o,s._result):s._state===j?D(o,s._result):R(s,void 0,function(t){return C(o,t)},function(t){return D(o,t)})):n===O?(D(t,O.error),O.error=null):void 0===n?k(t,e):c(n)?(r=e,i=n,u(function(e){var n=!1,t=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(i,r,function(t){n||(n=!0,r!==t?C(e,t):k(e,t))},function(t){n||(n=!0,D(e,t))},e._label);!n&&t&&(n=!0,D(e,t))},t)):k(t,e)}function C(t,e){var n,r;t===e?D(t,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=e),null===n||"object"!==r&&"function"!==r?k(t,e):A(t,e,S(e)))}function q(t){t._onerror&&t._onerror(t._result),P(t)}function k(t,e){t._state===T&&(t._result=e,t._state=E,0!==t._subscribers.length&&u(P,t))}function D(t,e){t._state===T&&(t._state=j,t._result=e,u(q,t))}function R(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+E]=n,i[o+j]=r,0===o&&t._state&&u(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,i=void 0,o=t._result,s=0;s<e.length;s+=3)r=e[s],i=e[s+n],r?N(n,r,i,o):i(o);t._subscribers.length=0}}function N(t,e,n,r){var i=c(n),o=void 0,s=void 0,u=void 0,a=void 0;if(i){if((o=function(t,e){try{return t(e)}catch(t){return O.error=t,O}}(n,r))===O?(a=!0,s=o.error,o.error=null):u=!0,e===o)return void D(e,new TypeError("A promises callback cannot return that same promise."))}else o=r,u=!0;e._state!==T||(i&&u?C(e,o):a?D(e,s):t===E?k(e,o):t===j&&D(e,o))}var I=0;function L(t){t[_]=I++,t._state=void 0,t._result=void 0,t._subscribers=[]}var F=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(x),this.promise[_]||L(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&k(this.promise,this._result))):D(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===T&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===g){var i=S(e);if(i===b&&e._state!==T)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===U){var o=new n(x);A(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===T&&(this._remaining--,t===j?D(r,n):this._result[e]=n),0===this._remaining&&k(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;R(t,void 0,function(t){return n._settledAt(E,e,t)},function(t){return n._settledAt(j,e,t)})},t}();var U=function(){function e(t){this[_]=I++,this._result=this._state=void 0,this._subscribers=[],x!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){C(e,t)},function(t){D(e,t)})}catch(t){D(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})})},e}();return U.prototype.then=b,U.all=function(t){return new F(this,t).promise},U.race=function(i){var o=this;return n(i)?new o(function(t,e){for(var n=i.length,r=0;r<n;r++)o.resolve(i[r]).then(t,e)}):new o(function(t,e){return e(new TypeError("You must pass an array to race."))})},U.resolve=g,U.reject=function(t){var e=new this(x);return D(e,t),e},U._setScheduler=function(t){i=t},U._setAsap=function(t){u=t},U._asap=u,U.polyfill=function(){var t=void 0;if(void 0!==z)t=z;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=U},U.Promise=U},"object"==typeof r&&void 0!==n?n.exports=e():t.ES6Promise=e()}).call(this,M("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:9}],6:[function(t,e,n){"use strict";e.exports=function(t){if("function"!=typeof t)throw new Error("Could not parse function signature for injection dependencies: Object is not a function");if(!t.length)return[];var e=/^()\(?([^)=]*)\)? *=>/.exec(t+"")||/^[^(]+([^ \(]*) *\(([^\)]*)\)/.exec(t+"");if(!e)throw new Error("Could not parse function signature for injection dependencies: "+t);var n=e[2].replace(/\/\*[\S\s]*?\*\//g," ").replace(/\/\/.*/g," ");function r(t,e,n){return e+n.split(",").map(function(t){return t&&t.trim()}).filter(Boolean).join("@")}return(n=(n=n.replace(/(\{)([^}]*)\}/g,r)).replace(/(\[)([^}]*)\]/g,r)).split(",").map(function(t){return t&&t.trim()}).map(function(t){return"{"===t[0]?t.substring(1).split("@"):"["===t[0]?{items:t.substring(1).split("@")}:t}).filter(Boolean)}},{}],7:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],8:[function(t,e,n){"use strict";var a=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,r,i=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),o=1;o<arguments.length;o++){for(var s in n=Object(arguments[o]))c.call(n,s)&&(i[s]=n[s]);if(a){r=a(n);for(var u=0;u<r.length;u++)l.call(n,r[u])&&(i[r[u]]=n[r[u]])}}return i}},{}],9:[function(t,e,n){var r,i,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:u}catch(t){i=u}}();var c,l=[],f=!1,p=-1;function h(){f&&c&&(f=!1,c.length?l=c.concat(l):p=-1,l.length&&d())}function d(){if(!f){var t=a(h);f=!0;for(var e=l.length;e;){for(c=l,l=[];++p<e;)c&&c[p].run();p=-1,e=l.length}c=null,f=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===u||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new y(t,e)),1!==l.length||f||a(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],10:[function(t,e,n){function r(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(t){r.prototype[t]=function(){return this._defaults.push({fn:t,arguments:arguments}),this}}),r.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})},e.exports=r},{}],11:[function(t,e,n){var r;r="undefined"!=typeof window?window:"undefined"!=typeof self?self:(console.warn("Using browser-only version of superagent in non-browser environment"),this);var i=t("component-emitter"),o=t("./request-base"),s=t("./is-object"),u=t("./response-base"),a=t("./agent-base");function c(){}var l=n=e.exports=function(t,e){return"function"==typeof e?new n.Request("GET",t).end(e):1==arguments.length?new n.Request("GET",t):new n.Request(t,e)};n.Request=v,l.getXHR=function(){if(!(!r.XMLHttpRequest||r.location&&"file:"==r.location.protocol&&r.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw Error("Browser-only version of superagent could not find XHR")};var f="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function p(t){if(!s(t))return t;var e=[];for(var n in t)h(e,n,t[n]);return e.join("&")}function h(e,n,t){if(null!=t)if(Array.isArray(t))t.forEach(function(t){h(e,n,t)});else if(s(t))for(var r in t)h(e,n+"["+r+"]",t[r]);else e.push(encodeURIComponent(n)+"="+encodeURIComponent(t));else null===t&&e.push(encodeURIComponent(n))}function d(t){for(var e,n,r={},i=t.split("&"),o=0,s=i.length;o<s;++o)-1==(n=(e=i[o]).indexOf("="))?r[decodeURIComponent(e)]="":r[decodeURIComponent(e.slice(0,n))]=decodeURIComponent(e.slice(n+1));return r}function y(t){return/[\/+]json($|[^-\w])/.test(t)}function m(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.header=this.headers=function(t){for(var e,n,r,i,o=t.split(/\r?\n/),s={},u=0,a=o.length;u<a;++u)-1!==(e=(n=o[u]).indexOf(":"))&&(r=n.slice(0,e).toLowerCase(),i=f(n.slice(e+1)),s[r]=i);return s}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&t._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function v(t,e){var r=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var e,n=null,t=null;try{t=new m(r)}catch(t){return(n=new Error("Parser is unable to parse the response")).parse=!0,n.original=t,r.xhr?(n.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,n.status=r.xhr.status?r.xhr.status:null,n.statusCode=n.status):(n.rawResponse=null,n.status=null),r.callback(n)}r.emit("response",t);try{r._isResponseOK(t)||(e=new Error(t.statusText||"Unsuccessful HTTP response"))}catch(t){e=t}e?(e.original=n,e.response=t,e.status=t.status,r.callback(e,t)):r.callback(null,t)})}function w(t,e,n){var r=l("DELETE",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}l.serializeObject=p,l.parseString=d,l.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},l.serialize={"application/x-www-form-urlencoded":p,"application/json":JSON.stringify},l.parse={"application/x-www-form-urlencoded":d,"application/json":JSON.parse},u(m.prototype),m.prototype._parseBody=function(t){var e=l.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&y(this.type)&&(e=l.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null)},m.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r="cannot "+e+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=e,i.url=n,i},l.Response=m,i(v.prototype),o(v.prototype),v.prototype.type=function(t){return this.set("Content-Type",l.types[t]||t),this},v.prototype.accept=function(t){return this.set("Accept",l.types[t]||t),this},v.prototype.auth=function(t,e,n){1===arguments.length&&(e=""),"object"==typeof e&&null!==e&&(n=e,e=""),n||(n={type:"function"==typeof btoa?"basic":"auto"});return this._auth(t,e,n,function(t){if("function"==typeof btoa)return btoa(t);throw new Error("Cannot use basic auth, btoa is not a function")})},v.prototype.query=function(t){return"string"!=typeof t&&(t=p(t)),t&&this._query.push(t),this},v.prototype.attach=function(t,e,n){if(e){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,n||e.name)}return this},v.prototype._getFormData=function(){return this._formData||(this._formData=new r.FormData),this._formData},v.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();var n=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),n(t,e)},v.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},v.prototype.buffer=v.prototype.ca=v.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},v.prototype.pipe=v.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},v.prototype._isHost=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},v.prototype.end=function(t){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||c,this._finalizeQueryString(),this._end()},v.prototype._end=function(){var n=this,r=this.xhr=l.getXHR(),t=this._formData||this._data;this._setTimeouts(),r.onreadystatechange=function(){var t=r.readyState;if(2<=t&&n._responseTimeoutTimer&&clearTimeout(n._responseTimeoutTimer),4==t){var e;try{e=r.status}catch(t){e=0}if(!e){if(n.timedout||n._aborted)return;return n.crossDomainError()}n.emit("end")}};var e=function(t,e){0<e.total&&(e.percent=e.loaded/e.total*100),e.direction=t,n.emit("progress",e)};if(this.hasListeners("progress"))try{r.onprogress=e.bind(null,"download"),r.upload&&(r.upload.onprogress=e.bind(null,"upload"))}catch(t){}try{this.username&&this.password?r.open(this.method,this.url,!0,this.username,this.password):r.open(this.method,this.url,!0)}catch(t){return this.callback(t)}if(this._withCredentials&&(r.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof t&&!this._isHost(t)){var i=this._header["content-type"],o=this._serializer||l.serialize[i?i.split(";")[0]:""];!o&&y(i)&&(o=l.serialize["application/json"]),o&&(t=o(t))}for(var s in this.header)null!=this.header[s]&&this.header.hasOwnProperty(s)&&r.setRequestHeader(s,this.header[s]);return this._responseType&&(r.responseType=this._responseType),this.emit("request",this),r.send(void 0!==t?t:null),this},l.agent=function(){return new a},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(r){a.prototype[r.toLowerCase()]=function(t,e){var n=new l.Request(r,t);return this._setDefaults(n),e&&n.end(e),n}}),a.prototype.del=a.prototype.delete,l.get=function(t,e,n){var r=l("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},l.head=function(t,e,n){var r=l("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},l.options=function(t,e,n){var r=l("OPTIONS",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},l.del=w,l.delete=w,l.patch=function(t,e,n){var r=l("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},l.post=function(t,e,n){var r=l("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},l.put=function(t,e,n){var r=l("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}},{"./agent-base":10,"./is-object":12,"./request-base":13,"./response-base":14,"component-emitter":4}],12:[function(t,e,n){"use strict";e.exports=function(t){return null!==t&&"object"==typeof t}},{}],13:[function(t,e,n){"use strict";var i=t("./is-object");function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}(e.exports=r).prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},r.prototype.parse=function(t){return this._parser=t,this},r.prototype.responseType=function(t){return this._responseType=t,this},r.prototype.serialize=function(t){return this._serializer=t,this},r.prototype.timeout=function(t){if(!t||"object"!=typeof t)return this._timeout=t,this._responseTimeout=0,this;for(var e in t)switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;default:console.warn("Unknown timeout option",e)}return this},r.prototype.retry=function(t,e){return 0!==arguments.length&&!0!==t||(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var o=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];r.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(t,e);if(!0===n)return!0;if(!1===n)return!1}catch(t){console.error(t)}if(e&&e.status&&500<=e.status&&501!=e.status)return!0;if(t){if(t.code&&~o.indexOf(t.code))return!0;if(t.timeout&&"ECONNABORTED"==t.code)return!0;if(t.crossDomain)return!0}return!1},r.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},r.prototype.then=function(t,e){if(!this._fullfilledPromise){var i=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(n,r){i.end(function(t,e){t?r(t):n(e)})})}return this._fullfilledPromise.then(t,e)},r.prototype.catch=function(t){return this.then(void 0,t)},r.prototype.use=function(t){return t(this),this},r.prototype.ok=function(t){if("function"!=typeof t)throw Error("Callback required");return this._okCallback=t,this},r.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):200<=t.status&&t.status<300)},r.prototype.getHeader=r.prototype.get=function(t){return this._header[t.toLowerCase()]},r.prototype.set=function(t,e){if(i(t)){for(var n in t)this.set(n,t[n]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},r.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},r.prototype.field=function(t,e){if(null==t)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),i(t)){for(var n in t)this.field(n,t[n]);return this}if(Array.isArray(e)){for(var r in e)this.field(t,e[r]);return this}if(null==e)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=""+e),this._getFormData().append(t,e),this},r.prototype.abort=function(){return this._aborted||(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort")),this},r.prototype._auth=function(t,e,n,r){switch(n.type){case"basic":this.set("Authorization","Basic "+r(t+":"+e));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer "+t)}return this},r.prototype.withCredentials=function(t){return null==t&&(t=!0),this._withCredentials=t,this},r.prototype.redirects=function(t){return this._maxRedirects=t,this},r.prototype.maxResponseSize=function(t){if("number"!=typeof t)throw TypeError("Invalid argument");return this._maxResponseSize=t,this},r.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},r.prototype.send=function(t){var e=i(t),n=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(e&&i(this._data))for(var r in t)this._data[r]=t[r];else this._data="string"==typeof t?(n||this.type("form"),"application/x-www-form-urlencoded"==(n=this._header["content-type"])?this._data?this._data+"&"+t:t:(this._data||"")+t):t;return!e||this._isHost(t)||n||this.type("json"),this},r.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},r.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(0<=this.url.indexOf("?")?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(0<=e){var n=this.url.substring(e+1).split("&");"function"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,e)+"?"+n.join("&")}}},r.prototype._appendQueryString=function(){console.trace("Unsupported")},r.prototype._timeoutError=function(t,e,n){if(!this._aborted){var r=new Error(t+e+"ms exceeded");r.timeout=e,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},r.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},{"./is-object":12}],14:[function(t,e,n){"use strict";var i=t("./utils");function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}(e.exports=r).prototype.get=function(t){return this.header[t.toLowerCase()]},r.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=i.type(e);var n=i.params(e);for(var r in n)this[r]=n[r];this.links={};try{t.link&&(this.links=i.parseLinks(t.link))}catch(t){}},r.prototype._setStatusProperties=function(t){var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.redirect=3==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.created=201==t,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.forbidden=403==t,this.notFound=404==t,this.unprocessableEntity=422==t}},{"./utils":15}],15:[function(t,e,n){"use strict";n.type=function(t){return t.split(/ *; */).shift()},n.params=function(t){return t.split(/ *; */).reduce(function(t,e){var n=e.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(t[r]=i),t},{})},n.parseLinks=function(t){return t.split(/ *, */).reduce(function(t,e){var n=e.split(/ *; */),r=n[0].slice(1,-1);return t[n[1].split(/ *= */)[1].slice(1,-1)]=r,t},{})},n.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t}},{}],16:[function(t,e,n){(function(n){function r(t){try{if(!n.localStorage)return!1}catch(t){return!1}var e=n.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}e.exports=function(t,e){if(r("noDeprecation"))return t;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(e);r("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],18:[function(p,t,S){(function(r,i){var u=/%[sdj%]/g;S.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,o=String(t).replace(u,function(t){if("%%"===t)return"%";if(i<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<i;s=r[++n])w(s)||!l(s)?o+=" "+s:o+=" "+a(s);return o},S.deprecate=function(t,e){if(_(i.process))return function(){return S.deprecate(t,e).apply(this,arguments)};if(!0===r.noDeprecation)return t;var n=!1;return function(){if(!n){if(r.throwDeprecation)throw new Error(e);r.traceDeprecation?console.trace(e):console.error(e),n=!0}return t.apply(this,arguments)}};var t,o={};function a(t,e){var n={seen:[],stylize:c};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),v(e)?n.showHidden=e:e&&S._extend(n,e),_(n.showHidden)&&(n.showHidden=!1),_(n.depth)&&(n.depth=2),_(n.colors)&&(n.colors=!1),_(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),h(n,t,n.depth)}function s(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function c(t,e){return t}function h(e,n,r){if(e.customInspect&&n&&j(n.inspect)&&n.inspect!==S.inspect&&(!n.constructor||n.constructor.prototype!==n)){var t=n.inspect(r,e);return g(t)||(t=h(e,t,r)),t}var i=function(t,e){if(_(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(b(e))return t.stylize(""+e,"number");if(v(e))return t.stylize(""+e,"boolean");if(w(e))return t.stylize("null","null")}(e,n);if(i)return i;var o,s=Object.keys(n),u=(o={},s.forEach(function(t,e){o[t]=!0}),o);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),E(n)&&(0<=s.indexOf("message")||0<=s.indexOf("description")))return d(n);if(0===s.length){if(j(n)){var a=n.name?": "+n.name:"";return e.stylize("[Function"+a+"]","special")}if(x(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(T(n))return e.stylize(Date.prototype.toString.call(n),"date");if(E(n))return d(n)}var c,l="",f=!1,p=["{","}"];(m(n)&&(f=!0,p=["[","]"]),j(n))&&(l=" [Function"+(n.name?": "+n.name:"")+"]");return x(n)&&(l=" "+RegExp.prototype.toString.call(n)),T(n)&&(l=" "+Date.prototype.toUTCString.call(n)),E(n)&&(l=" "+d(n)),0!==s.length||f&&0!=n.length?r<0?x(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=f?function(e,n,r,i,t){for(var o=[],s=0,u=n.length;s<u;++s)O(n,String(s))?o.push(y(e,n,r,i,String(s),!0)):o.push("");return t.forEach(function(t){t.match(/^\d+$/)||o.push(y(e,n,r,i,t,!0))}),o}(e,n,r,u,s):s.map(function(t){return y(e,n,r,u,t,f)}),e.seen.pop(),function(t,e,n){if(60<t.reduce(function(t,e){return 0,0<=e.indexOf("\n")&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0))return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,l,p)):p[0]+l+p[1]}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function y(t,e,n,r,i,o){var s,u,a;if((a=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?u=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(u=t.stylize("[Setter]","special")),O(r,i)||(s="["+i+"]"),u||(t.seen.indexOf(a.value)<0?-1<(u=w(n)?h(t,a.value,null):h(t,a.value,n-1)).indexOf("\n")&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),_(s)){if(o&&i.match(/^\d+$/))return u;s=(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(s,"string"))}return s+": "+u}function m(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function w(t){return null===t}function b(t){return"number"==typeof t}function g(t){return"string"==typeof t}function _(t){return void 0===t}function x(t){return l(t)&&"[object RegExp]"===e(t)}function l(t){return"object"==typeof t&&null!==t}function T(t){return l(t)&&"[object Date]"===e(t)}function E(t){return l(t)&&("[object Error]"===e(t)||t instanceof Error)}function j(t){return"function"==typeof t}function e(t){return Object.prototype.toString.call(t)}function n(t){return t<10?"0"+t.toString(10):t.toString(10)}S.debuglog=function(e){if(_(t)&&(t=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(t)){var n=r.pid;o[e]=function(){var t=S.format.apply(S,arguments);console.error("%s %d: %s",e,n,t)}}else o[e]=function(){};return o[e]},(S.inspect=a).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},S.isArray=m,S.isBoolean=v,S.isNull=w,S.isNullOrUndefined=function(t){return null==t},S.isNumber=b,S.isString=g,S.isSymbol=function(t){return"symbol"==typeof t},S.isUndefined=_,S.isRegExp=x,S.isObject=l,S.isDate=T,S.isError=E,S.isFunction=j,S.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},S.isBuffer=p("./support/isBuffer");var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[n(t.getHours()),n(t.getMinutes()),n(t.getSeconds())].join(":"),[t.getDate(),f[t.getMonth()],e].join(" ")),S.format.apply(S,arguments))},S.inherits=p("inherits"),S._extend=function(t,e){if(!e||!l(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,p("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":17,_process:9,inherits:7}],19:[function(t,e,n){"use strict";var u=t("btoa-lite"),a=t("superagent"),p=t("./errors"),r=t("./query"),i=t("./values"),h=t("./_json"),d=t("./RequestResult"),o=t("./_util"),s=t("./PageHelper"),c=t("es6-promise").Promise;function l(t){var e=o.applyDefaults(t,{domain:"db.fauna.com",scheme:"https",port:null,secret:null,timeout:60,observer:null});null===e.port&&(e.port="https"===e.scheme?443:80),this._baseUrl=e.scheme+"://"+e.domain+":"+e.port,this._timeout=Math.floor(1e3*e.timeout),this._secret=e.secret,this._observer=e.observer,this._lastSeen=null}function y(t,e){return void 0===t?e:t}l.prototype.query=function(t){return this._execute("POST","",r.wrap(t))},l.prototype.paginate=function(t,e){return e=y(e,{}),new s(this,t,e)},l.prototype.ping=function(t,e){return this._execute("GET","ping",null,{scope:t,timeout:e})},l.prototype._execute=function(s,u,a,c){c=y(c,null),u instanceof i.Ref&&(u=u.value),null!==c&&(c=o.removeUndefinedValues(c));var l=Date.now(),f=this;return this._performRequest(s,u,a,c).then(function(t,e){var n=Date.now(),r=h.parseJSON(t.text),i=new d(f,s,u,c,e,a,t.text,r,t.status,t.header,l,n);if("x-last-seen-txn"in t.header){var o=parseInt(t.header["x-last-seen-txn"],10);null==f._lastSeen?f._lastSeen=o:f._lastSeen<o&&(f._lastSeen=o)}return null!=f._observer&&f._observer(i),p.FaunaHTTPError.raiseForStatusCode(i),r.resource})},l.prototype._performRequest=function(t,e,n,r){var i=a(t,this._baseUrl+"/"+e);r&&i.query(r);var o,s=JSON.stringify(n);return i.type("json"),i.send(s),this._secret&&i.set("Authorization",(o=this._secret,"Basic "+u(o+":"))),this._lastSeen&&i.set("X-Last-Seen-Txn",this._lastSeen),i.set("X-FaunaDB-API-Version","2.1"),i.timeout(this._timeout),new c(function(n,r){i.end(function(t,e){t&&void 0===t.response?r(t):!t||!t.response||400<=t.response.status&&t.response.status<=599?n(e,s):r(t)})})},e.exports=l},{"./PageHelper":21,"./RequestResult":22,"./_json":23,"./_util":24,"./errors":26,"./query":27,"./values":28,"btoa-lite":3,"es6-promise":5,superagent:11}],20:[function(t,e,n){"use strict";function u(t){this.raw=t}u.prototype.toJSON=function(){return this.raw};var a=["Do","Call","Union","Intersection","Difference","Equals","Add","Multiply","Subtract","Divide","Modulo","LT","LTE","GT","GTE","And","Or"],c={is_nonempty:"is_non_empty",lt:"LT",lte:"LTE",gt:"GT",gte:"GTE"},l=function(n,t){n instanceof u&&(n=n.raw);var e=typeof n;if("string"===e)return'"'+n+'"';if("symbol"===e||"number"===e||"boolean"===e)return n.toString();if("undefined"===e)return"undefined";if(null===n)return"null";if(Array.isArray(n)){var r=n.map(function(t){return l(t)}).join(", ");return a.includes(t)?r:"["+r+"]"}var i=Object.keys(n),o=i[0];if("object"===o)return"{"+Object.keys(n.object).map(function(t){return t+": "+l(n.object[t])}).join(", ")+"}";o in c&&(o=c[o]),o=o.split("_").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join("");var s=i.map(function(t){var e=n[t];return l(e,o)}).join(", ");return o+"("+s+")"};u.toString=l,e.exports=u},{}],21:[function(t,e,n){"use strict";var i=t("./query"),o=t("object-assign"),s=t("es6-promise").Promise;function r(t,e,n){void 0===n&&(n={}),this.reverse=!1,this.params={},this.before=void 0,this.after=void 0,o(this.params,n),"before"in n?(this.before=n.before,delete this.params.before):"after"in n&&(this.after=n.after,delete this.params.after),this.client=t,this.set=e,this._faunaFunctions=[]}r.prototype.map=function(e){var t=this._clone();return t._faunaFunctions.push(function(t){return i.Map(t,e)}),t},r.prototype.filter=function(e){var t=this._clone();return t._faunaFunctions.push(function(t){return i.Filter(t,e)}),t},r.prototype.each=function(t){return this._retrieveNextPage(this.after,!1).then(this._consumePages(t,!1))},r.prototype.eachReverse=function(t){return this._retrieveNextPage(this.before,!0).then(this._consumePages(t,!0))},r.prototype.previousPage=function(){return this._retrieveNextPage(this.before,!0).then(this._adjustCursors.bind(this))},r.prototype.nextPage=function(){return this._retrieveNextPage(this.after,!1).then(this._adjustCursors.bind(this))},r.prototype._adjustCursors=function(t){return void 0!==t.after&&(this.after=t.after),void 0!==t.before&&(this.before=t.before),t.data},r.prototype._consumePages=function(n,r){var i=this;return function(t){var e;return n(t.data),void 0!==(e=r?t.before:t.after)?i._retrieveNextPage(e,r).then(i._consumePages(n,r)):s.resolve()}},r.prototype._retrieveNextPage=function(t,e){var n={};o(n,this.params),void 0!==t?e?n.before=t:n.after=t:e&&(n.before=null);var r=i.Paginate(this.set,n);return 0<this._faunaFunctions.length&&this._faunaFunctions.forEach(function(t){r=t(r)}),this.client.query(r)},r.prototype._clone=function(){return Object.create(r.prototype,{client:{value:this.client},set:{value:this.set},_faunaFunctions:{value:this._faunaFunctions},before:{value:this.before},after:{value:this.after}})},e.exports=r},{"./query":27,"es6-promise":5,"object-assign":8}],22:[function(t,e,n){"use strict";function r(t,e,n,r,i,o,s,u,a,c,l,f){this.client=t,this.method=e,this.path=n,this.query=r,this.requestRaw=i,this.requestContent=o,this.responseRaw=s,this.responseContent=u,this.statusCode=a,this.responseHeaders=c,this.startTime=l,this.endTime=f}Object.defineProperty(r.prototype,"auth",{get:function(){return this.client._secret}}),Object.defineProperty(r.prototype,"timeTaken",{get:function(){return this.endTime-this.startTime}}),e.exports=r},{}],23:[function(t,e,n){"use strict";var o=t("./values");function s(t,e){if("object"!=typeof e||null===e)return e;if("@ref"in e){var n=e["@ref"];if(!("class"in n||"database"in n))return o.Native.fromName(n.id);var r=s("class",n.class),i=s("database",n.database);return new o.Ref(n.id,r,i)}return"@obj"in e?e["@obj"]:"@set"in e?new o.SetRef(e["@set"]):"@ts"in e?new o.FaunaTime(e["@ts"]):"@date"in e?new o.FaunaDate(e["@date"]):"@bytes"in e?new o.Bytes(e["@bytes"]):"@query"in e?new o.Query(e["@query"]):e}e.exports={toJSON:function(t,e){return(e=void 0!==e&&e)?JSON.stringify(t,null,"  "):JSON.stringify(t)},parseJSON:function(t){return JSON.parse(t,s)}}},{"./values":28}],24:[function(t,e,n){"use strict";e.exports={applyDefaults:function(t,e){var n={};for(var r in t){if(!(r in e))throw new Error("No such option "+r);n[r]=t[r]}for(var i in e)i in n||(n[i]=e[i]);return n},removeUndefinedValues:function(t){var e={};for(var n in t){var r=t[n];void 0!==r&&(e[n]=r)}return e}}},{}],25:[function(t,e,n){"use strict";var r=t("./_json");function i(t){var e=t.query,n=t.method,r=t.path,i=t.requestContent,o=t.responseHeaders,s=t.responseContent,u=t.statusCode,a=t.timeTaken,c="";function l(t){c+=t}return l("Fauna "+n+" /"+r+function(e){if(null==e)return"";var t=Object.keys(e);return 0!==t.length?"?"+t.map(function(t){return t+"="+e[t]}).join("&"):""}(e)+"\n"),null!=i&&l("  Request JSON: "+f(i)+"\n"),l("  Response headers: "+f(o)+"\n"),l("  Response JSON: "+f(s)+"\n"),l("  Response ("+u+"): Network latency "+a+"ms\n"),c}function f(t){return r.toJSON(t,!0).split("\n").join("\n  ")}e.exports={logger:function(e){return function(t){return e(i(t))}},showRequestResult:i}},{"./_json":23}],26:[function(t,e,n){"use strict";var r=t("util");function o(t,e){Error.call(this),this.name=t,this.message=e}function i(t){o.call(this,"InvalidValue",t)}function s(t,e,n){var r,i;o.call(this,"InvalidArity","Function requires "+(r=t,null===(i=e)?"at least "+r:null===r?"up to "+i:r===i?r:"from "+r+" to "+i)+" arguments but "+n+" were given."),this.min=t,this.max=e,this.actual=n}function u(t,e){var n=e.responseContent.errors,r=0===n.length?'(empty "errors")':n[0].code;o.call(this,t,r),this.requestResult=e}function a(t){u.call(this,"BadRequest",t)}function c(t){u.call(this,"Unauthorized",t)}function l(t){u.call(this,"PermissionDenied",t)}function f(t){u.call(this,"NotFound",t)}function p(t){u.call(this,"MethodNotAllowed",t)}function h(t){u.call(this,"InternalError",t)}function d(t){u.call(this,"UnavailableError",t)}r.inherits(o,Error),r.inherits(i,o),r.inherits(s,o),r.inherits(u,o),u.prototype.errors=function(){return this.requestResult.responseContent.errors},u.raiseForStatusCode=function(t){var e=t.statusCode;if(e<200||300<=e)switch(e){case 400:throw new a(t);case 401:throw new c(t);case 403:throw new l(t);case 404:throw new f(t);case 405:throw new p(t);case 500:throw new h(t);case 503:throw new d(t);default:throw new u("UnknownError",t)}},r.inherits(a,u),r.inherits(c,u),r.inherits(l,u),r.inherits(f,u),r.inherits(p,u),r.inherits(h,u),r.inherits(d,u),e.exports={FaunaHTTPError:u,InvalidValue:i,InvalidArity:s,BadRequest:a,Unauthorized:c,PermissionDenied:l,NotFound:f,MethodNotAllowed:p,InternalError:h,UnavailableError:d}},{util:18}],27:[function(t,e,n){"use strict";var r=t("fn-annotate"),i=t("util-deprecate"),o=t("./Expr"),s=t("./errors"),u=t("./values"),a=t("object-assign");function c(t){return p.exact(1,arguments),new o({var:v(t)})}function l(){switch(p.between(1,2,arguments),arguments.length){case 1:var t=arguments[0];if("function"==typeof t)return function(t){var e=r(t);switch(e.length){case 0:throw new s.InvalidValue("Provided Function must take at least 1 argument.");case 1:return f(e[0],t(c(e[0])));default:return f(e,t.apply(null,e.map(function(t){return c(t)})))}}(t);if(t instanceof o)return t;throw new s.InvalidValue("Lambda function takes either a Function or an Expr.");case 2:return f(arguments[0],arguments[1])}}function f(t,e){return new o({lambda:v(t),expr:v(e)})}function p(t,e,n){if(null!==t&&n.length<t||null!==e&&n.length>e)throw new s.InvalidArity(t,e,n.length)}function h(t,e){for(var n in e){var r=e[n];null!==r&&(t[n]=r)}return t}function d(t){var e=Array.isArray(t)?t:Array.prototype.slice.call(t);return 1===t.length?t[0]:e}function y(t){var e=[];return e.push.apply(e,t),e}function m(t,e){return void 0===t?e:t}function v(t){return p.exact(1,arguments),null===t?null:t instanceof o?t:"symbol"==typeof t?t.toString().replace(/Symbol\((.*)\)/,function(t,e){return e}):"function"==typeof t?l(t):Array.isArray(t)?new o(t.map(function(t){return v(t)})):t instanceof Uint8Array||t instanceof ArrayBuffer?new u.Bytes(t):"object"==typeof t?new o({object:w(t)}):t}function w(e){if(null===e)return null;var n={};return Object.keys(e).forEach(function(t){n[t]=v(e[t])}),n}p.exact=function(t,e){p(t,t,e)},p.max=function(t,e){p(null,t,e)},p.min=function(t,e){p(t,null,e)},p.between=function(t,e,n){p(t,e,n)},e.exports={Ref:function(){switch(p.between(1,2,arguments),arguments.length){case 1:return new o({"@ref":v(arguments[0])});case 2:return new o({ref:v(arguments[0]),id:v(arguments[1])})}},Bytes:function(t){return p.exact(1,arguments),new u.Bytes(t)},Abort:function(t){return p.exact(1,arguments),new o({abort:v(t)})},At:function(t,e){return p.exact(2,arguments),new o({at:v(t),expr:v(e)})},Let:function(t,e){return p.exact(2,arguments),"function"==typeof e&&(e=e.apply(null,Object.keys(t).map(function(t){return c(t)}))),new o({let:w(t),in:v(e)})},Var:c,If:function(t,e,n){return p.exact(3,arguments),new o({if:v(t),then:v(e),else:v(n)})},Do:function(){p.min(1,arguments);var t=y(arguments);return new o({do:v(t)})},Object:function(t){return p.exact(1,arguments),new o({object:w(t)})},Lambda:l,Call:function(t){p.min(1,arguments);var e=y(arguments);return e.shift(),new o({call:v(t),arguments:d(e)})},Query:function(t){return p.exact(1,arguments),new o({query:v(t)})},Map:function(t,e){return p.exact(2,arguments),new o({map:v(e),collection:v(t)})},Foreach:function(t,e){return p.exact(2,arguments),new o({foreach:v(e),collection:v(t)})},Filter:function(t,e){return p.exact(2,arguments),new o({filter:v(e),collection:v(t)})},Take:function(t,e){return p.exact(2,arguments),new o({take:v(t),collection:v(e)})},Drop:function(t,e){return p.exact(2,arguments),new o({drop:v(t),collection:v(e)})},Prepend:function(t,e){return p.exact(2,arguments),new o({prepend:v(t),collection:v(e)})},Append:function(t,e){return p.exact(2,arguments),new o({append:v(t),collection:v(e)})},IsEmpty:function(t){return p.exact(1,arguments),new o({is_empty:v(t)})},IsNonEmpty:function(t){return p.exact(1,arguments),new o({is_nonempty:v(t)})},Get:function(t,e){return p.between(1,2,arguments),e=m(e,null),new o(h({get:v(t)},{ts:v(e)}))},KeyFromSecret:function(t){return p.exact(1,arguments),new o({key_from_secret:v(t)})},Paginate:function(t,e){return p.between(1,2,arguments),e=m(e,{}),new o(a({paginate:v(t)},w(e)))},Exists:function(t,e){return p.between(1,2,arguments),e=m(e,null),new o(h({exists:v(t)},{ts:v(e)}))},Create:function(t,e){return p.between(1,2,arguments),new o({create:v(t),params:v(e)})},Update:function(t,e){return p.exact(2,arguments),new o({update:v(t),params:v(e)})},Replace:function(t,e){return p.exact(2,arguments),new o({replace:v(t),params:v(e)})},Delete:function(t){return p.exact(1,arguments),new o({delete:v(t)})},Insert:function(t,e,n,r){return p.exact(4,arguments),new o({insert:v(t),ts:v(e),action:v(n),params:v(r)})},Remove:function(t,e,n){return p.exact(3,arguments),new o({remove:v(t),ts:v(e),action:v(n)})},CreateClass:function(t){return p.exact(1,arguments),new o({create_class:v(t)})},CreateDatabase:function(t){return p.exact(1,arguments),new o({create_database:v(t)})},CreateIndex:function(t){return p.exact(1,arguments),new o({create_index:v(t)})},CreateKey:function(t){return p.exact(1,arguments),new o({create_key:v(t)})},CreateFunction:function(t){return p.exact(1,arguments),new o({create_function:v(t)})},Singleton:function(t){return p.exact(1,arguments),new o({singleton:v(t)})},Events:function(t){return p.exact(1,arguments),new o({events:v(t)})},Match:function(t){p.min(1,arguments);var e=y(arguments);return e.shift(),new o({match:v(t),terms:v(d(e))})},Union:function(){return p.min(1,arguments),new o({union:v(d(arguments))})},Intersection:function(){return p.min(1,arguments),new o({intersection:v(d(arguments))})},Difference:function(){return p.min(1,arguments),new o({difference:v(d(arguments))})},Distinct:function(t){return p.exact(1,arguments),new o({distinct:v(t)})},Join:function(t,e){return p.exact(2,arguments),new o({join:v(t),with:v(e)})},Login:function(t,e){return p.exact(2,arguments),new o({login:v(t),params:v(e)})},Logout:function(t){return p.exact(1,arguments),new o({logout:v(t)})},Identify:function(t,e){return p.exact(2,arguments),new o({identify:v(t),password:v(e)})},Identity:function(){return p.exact(0,arguments),new o({identity:null})},HasIdentity:function(){return p.exact(0,arguments),new o({has_identity:null})},Concat:function(t,e){return p.min(1,arguments),e=m(e,null),new o(h({concat:v(t)},{separator:v(e)}))},Casefold:function(t,e){return p.min(1,arguments),new o(h({casefold:v(t)},{normalizer:v(e)}))},NGram:function(t,e){return p.between(1,2,arguments),e=m(e,{}),new o(a({ngram:v(t)},w(e)))},Time:function(t){return p.exact(1,arguments),new o({time:v(t)})},Epoch:function(t,e){return p.exact(2,arguments),new o({epoch:v(t),unit:v(e)})},Date:function(t){return p.exact(1,arguments),new o({date:v(t)})},NextId:i(function(){return p.exact(0,arguments),new o({next_id:null})},"NextId() is deprecated, use NewId() instead"),NewId:function(){return p.exact(0,arguments),new o({new_id:null})},Database:function(t,e){switch(p.between(1,2,arguments),arguments.length){case 1:return new o({database:v(t)});case 2:return new o({database:v(t),scope:v(e)})}},Index:function(t,e){switch(p.between(1,2,arguments),arguments.length){case 1:return new o({index:v(t)});case 2:return new o({index:v(t),scope:v(e)})}},Class:function(t,e){switch(p.between(1,2,arguments),arguments.length){case 1:return new o({class:v(t)});case 2:return new o({class:v(t),scope:v(e)})}},Function:function(t,e){switch(p.between(1,2,arguments),arguments.length){case 1:return new o({function:v(t)});case 2:return new o({function:v(t),scope:v(e)})}},Classes:function(t){return p.max(1,arguments),t=m(t,null),new o({classes:v(t)})},Databases:function(t){return p.max(1,arguments),t=m(t,null),new o({databases:v(t)})},Indexes:function(t){return p.max(1,arguments),t=m(t,null),new o({indexes:v(t)})},Functions:function(t){return p.max(1,arguments),t=m(t,null),new o({functions:v(t)})},Keys:function(t){return p.max(1,arguments),t=m(t,null),new o({keys:v(t)})},Tokens:function(t){return p.max(1,arguments),t=m(t,null),new o({tokens:v(t)})},Credentials:function(t){return p.max(1,arguments),t=m(t,null),new o({credentials:v(t)})},Equals:function(){return p.min(1,arguments),new o({equals:d(arguments)})},Contains:function(t,e){return p.exact(2,arguments),new o({contains:v(t),in:v(e)})},Select:function(t,e,n){p.between(2,3,arguments);var r={select:v(t),from:v(e)};return void 0!==n&&(r.default=v(n)),new o(r)},SelectAll:function(t,e){return p.exact(2,arguments),new o({select_all:v(t),from:v(e)})},Add:function(){return p.min(1,arguments),new o({add:v(d(arguments))})},Multiply:function(){return p.min(1,arguments),new o({multiply:v(d(arguments))})},Subtract:function(){return p.min(1,arguments),new o({subtract:v(d(arguments))})},Divide:function(){return p.min(1,arguments),new o({divide:v(d(arguments))})},Modulo:function(){return p.min(1,arguments),new o({modulo:v(d(arguments))})},LT:function(){return p.min(1,arguments),new o({lt:v(d(arguments))})},LTE:function(){return p.min(1,arguments),new o({lte:v(d(arguments))})},GT:function(){return p.min(1,arguments),new o({gt:v(d(arguments))})},GTE:function(){return p.min(1,arguments),new o({gte:v(d(arguments))})},And:function(){return p.min(1,arguments),new o({and:v(d(arguments))})},Or:function(){return p.min(1,arguments),new o({or:v(d(arguments))})},Not:function(t){return p.exact(1,arguments),new o({not:v(t)})},ToString:function(t){return p.exact(1,arguments),new o({to_string:v(t)})},ToNumber:function(t){return p.exact(1,arguments),new o({to_number:v(t)})},ToTime:function(t){return p.exact(1,arguments),new o({to_time:v(t)})},ToDate:function(t){return p.exact(1,arguments),new o({to_date:v(t)})},wrap:v}},{"./Expr":20,"./errors":26,"./values":28,"fn-annotate":6,"object-assign":8,"util-deprecate":16}],28:[function(t,e,n){"use strict";var r=t("base64-js"),i=t("./errors"),o=t("./Expr"),s=t("util"),u=s&&s.inspect&&s.inspect.custom,a=s&&s.inspect||JSON.stringify;function c(){}function l(t,e,n){if(!t)throw new i.InvalidValue("id cannot be null or undefined");this.value={id:t},e&&(this.value.class=e),n&&(this.value.database=n)}s.inherits(c,o),s.inherits(l,c),Object.defineProperty(l.prototype,"class",{get:function(){return this.value.class}}),Object.defineProperty(l.prototype,"database",{get:function(){return this.value.database}}),Object.defineProperty(l.prototype,"id",{get:function(){return this.value.id}}),l.prototype.toJSON=function(){return{"@ref":this.value}},v(l,function(){var i={classes:"Class",databases:"Database",indexes:"Index",functions:"Function"},o=function(t,e){if(void 0===t.class&&void 0===t.database)return t.id.charAt(0).toUpperCase()+t.id.slice(1)+"("+e+")";var n=i[t.class.id];if(void 0!==n){var r=void 0!==t.database?", "+t.database.toString():"";return n+'("'+t.id+'"'+r+")"}r=void 0!==t.database?t.database.toString():"";return"Ref("+o(t.class,r)+', "'+t.id+'")'};return o(this,"")}),l.prototype.valueOf=function(){return this.value},l.prototype.equals=function(t){return t instanceof l&&this.id===t.id&&(void 0===this.class&&void 0===t.class||this.class.equals(t.class))&&(void 0===this.database&&void 0===t.database||this.database.equals(t.database))};var f={CLASSES:new l("classes"),INDEXES:new l("indexes"),DATABASES:new l("databases"),FUNCTIONS:new l("functions"),KEYS:new l("keys")};function p(t){this.value=t}function h(t){if(t instanceof Date)t=t.toISOString();else if("Z"!==t.charAt(t.length-1))throw new i.InvalidValue("Only allowed timezone is 'Z', got: "+t);this.value=t}function d(t){t instanceof Date&&(t=t.toISOString().slice(0,10)),this.value=t}function y(t){if(t instanceof ArrayBuffer)this.value=new Uint8Array(t);else if("string"==typeof t)this.value=r.toByteArray(t);else{if(!(t instanceof Uint8Array))throw new i.InvalidValue("Bytes type expect argument to be either Uint8Array|ArrayBuffer|string, got: "+a(t));this.value=t}}function m(t){this.value=t}function v(t,e){t.prototype.toString=e,t.prototype.inspect=e,u&&(t.prototype[u]=e)}f.fromName=function(t){switch(t){case"classes":return f.CLASSES;case"indexes":return f.INDEXES;case"databases":return f.DATABASES;case"functions":return f.FUNCTIONS;case"keys":return f.KEYS}return new l(t)},s.inherits(p,c),v(p,function(){return"SetRef("+a(this.value)+")"}),p.prototype.toJSON=function(){return{"@set":this.value}},s.inherits(h,c),Object.defineProperty(h.prototype,"date",{get:function(){return new Date(this.value)}}),v(h,function(){return'Time("'+this.value+'")'}),h.prototype.toJSON=function(){return{"@ts":this.value}},s.inherits(d,c),Object.defineProperty(d.prototype,"date",{get:function(){return new Date(this.value)}}),v(d,function(){return'Date("'+this.value+'")'}),d.prototype.toJSON=function(){return{"@date":this.value}},s.inherits(y,c),v(y,function(){return'Bytes("'+r.fromByteArray(this.value)+'")'}),y.prototype.toJSON=function(){return{"@bytes":r.fromByteArray(this.value)}},s.inherits(m,c),v(m,function(){return"Query("+o.toString(this.value)+")"}),m.prototype.toJSON=function(){return{"@query":this.value}},e.exports={Value:c,Ref:l,Native:f,SetRef:p,FaunaTime:h,FaunaDate:d,Bytes:y,Query:m}},{"./Expr":20,"./errors":26,"base64-js":2,util:18}]},{},[1])(1)});